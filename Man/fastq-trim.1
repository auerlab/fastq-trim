.TH fastq-trim 1
.SH NAME    \" Section header
.PP
 
fastq-trim - Trim adapters and low-quality bases from FASTQ files

\" Convention:
\" Underline anything that is typed verbatim - commands, etc.
.SH SYNOPSIS
.PP
.nf 
.na 
fastq-trim [--help]
fastq-trim
    [--3p-adapter seq] [--min-qual N] [--min-length N]
    [file.fastq[.gz|.bz2|.xz]] [file.fastq[.gz|.bz2|.xz]]
.ad
.fi

.SH OPTIONS
.TP
\fB\-\-help\fR
Print a summary of usage and exit.

.TP
\fB\-\-verbose\fR
Print some intermediate results during trimming for debugging purposes.

.TP
\fB\-\-exact-match\fR \fIN\fR
Use exact matching to find adapters.  Adapters will be matched if a segment
matches the entire adapter sequence, or a portion of it at the end of the
read matches to a minimum of min_match (default=3, controlled by
--min-match) characters.  The default matching algorithm used when
--exact-match is not specified is described below.

.TP
\fB\-\-3p-adapter1\fR \fIseq\fR
Specify the 3' adapter for single-end mode and read1 in paired-end mode.
Default is the Illumina universal
adapter, AGATCGGAAGAG.  Use fastq-vis(1) to identify other standard adapters
in the input.

.TP
\fB\-\-3p-adapter1\fR \fIseq\fR
Specify the 3' adapter for read2 in paired-end mode.
Default is the Illumina universal
adapter, AGATCGGAAGAG.  Use fastq-vis(1) to identify other standard adapters
in the input.

.TP
\fB\-\-min-match\fR \fIN\fR
Minimum number of bases in the read that must match the adapter in order
to report a match.  This applies to both exact matching and smart matching.

.TP
\fB\-\-max-mismatch-percent\fR \fIN\fR
Maximum percentage of bases in the read can differ from the adapter and
still consider it a match.  This applies only to smart matching.  Increasing
the value from the default 10% slows down processing slightly, reduces the
number of missed adapters, and increases the risk of removing real data
resembling adapters.

.TP
\fB\-\-min-qual\fR \fIN\fR
Minimum quality of bases to keep for end-trimming.  Default is 20.

.TP
\fB\-\-min-length\fR \fIN\fR
Minimum length of reads to keep after trimming.  Default is 30.

.TP
\fB\-\-phred-base\fR \fIN\fR
Offset used for characters in quality string.  Default is 33, which should
be the correct value for virtually all modern sequence data.

.SH "DESCRIPTION"

.B Fastq-trim
removes adapters and low-quality bases from the ends of each read in a
FASTQ file.  Reads with a length less than the specified or default
minimum are not output.

Note that adapter matching (A.K.A. alignment) is not an exact science.
Most bioinformatics data contain errors and hence the processing must be
probabalistic.   It is possible that
an adapter sequence occurs naturally in a given sample.  The longer the
adapter, the less often this will occur, which is why adapters are typically
12 or more bases long.  Also, read errors can occur in adapters as well as
in the insert (the real DNA/RNA sequence between the adapters).  This is
rare and using an exact match algorithm like memcmp(3) will generally find
more than 99% of adapters.

Tolerating some slop in adapter matching will result in fewer adapters left
in the data and a higher risk of false positives (removing natural sequences
resembling adapters).  Neither situation is catastrophic.  If a fraction of
a percent of reads will not align to a genome properly because of adapter
contamination, the end results of the downstream analysis won't tell a
different story.  The same is true of reads that were shortened by removing
a falsely identified adapter.

The default tolerance is 10% of the adapter length (or the remaining bases
at the end of the read if that's shorter).  This can be increased using
--max-mismatch_percent.

The default "smart" adapter matching allows for roughly 10% of the bases to be
substituted.  No insertions or deletions are currently handled for adapter
matching.

Exact matching can be selected using --exact-match.
In either case, a minimum of min_match (default 3, controlled by
--min-match) bases must be matched in order to decide that the sequence
is indeed an adapter.

Low-quality 3' end removal uses the same algorithm as fastq and cutadapt,
namely scanning backward from the 3' end until the sum of (score - min-qual)
becomes > 0, then trimming at the location of the minimum sum.  Quality
trimming is done before adapter matching so that likely misread bases do not
contribute to the adapter match scoring.

.SH "SEE ALSO"
fastq-vis(1), biolibc(3)

.SH BUGS
Please report bugs to the author and send patches in unified diff format.
(man diff for more information)

.SH AUTHOR
.nf
.na
J. Bacon
